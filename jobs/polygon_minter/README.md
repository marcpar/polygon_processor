# Polygon NFT Minter

# Environment Configuration
| Key | Description |
| :-- | :---------- |
| `AZURE_ACCOUNT_NAME` | **REQUIRED**. azure account name |
| `AZURE_ACCOUNT_KEY` | **REQUIRED**. azure secret key |
| `TOPIC` | **REQUIRED**. name of the topic |
| `PRIVATE_KEY`| **REQUIRED**. private key of the wallet that will mint the nft |
| `CONTRACT_ADDRESS` | **REQUIRED**. address of the nft smart contract |
| `DEFAULT_CALLBACK_URL` | **REQUIRED**. endpoint where webhook events are sent |
| `MAX_JOBS` | maximum number of jobs to be processed at the same time, setting to 0 will have no limit |
| `LOG_LEVEL` | [winston log level](https://www.npmjs.com/package/winston#logging-levels)|
| `OPENSEA_BASE_URL` |  **REQUIRED**. opensea base url |
| `RPC_URL` | **REQUIRED**. rpc node to use |

# Job Spec
```json
{
    "JobId": "ff975cbd-32f4-4f09-9b9a-01964dd6eb90",
    "ArweaveTxnId": "DlJrvsf-eShZy2_J5AY7ptFz_Phfv7p8a5nkuVGfLmk"
}
```

| Field | Description |
| :---- | :---------- |
| `JobId` | **REQUIRED**. A unique string generated by the publisher of the message |
| `ArweaveTxnId` | **REQUIRED**. Arweave txn id, the uri of the nft will be ar:<ArweaveTxnId>/opensea.json |

## Events

the processor will emit events and send it to the configured `DEFAULT_CALLBACK_URL`.

### Started Event
Emmited to notify the callback url that the processor has received the job and is currently processing it.
```json
{
    "JobId": "ff975cbd-32f4-4f09-9b9a-01964dd6eb90",
    "Event": "started",
    "Time": 1659965535,
    "Message": "Job Started"
}
```
### Failure Event
Emmited to notify the callback url that an error has occured.
```json
{
    "JobId": "ff975cbd-32f4-4f09-9b9a-01964dd6eb90",
    "Event": "failure",
    "Time": 1659965535,
    "Message": "Example Error Message"
}

```
### Success Event
Emmited to notify the callback url that the job has successfully finished.
```json
{
    "JobId": "ff975cbd-32f4-4f09-9b9a-01964dd6eb90",
    "Event": "success",
    "Message": "Job ff975cbd-32f4-4f09-9b9a-01964dd6eb90 has been successfully processed",
    "Details": {
        "ExplorerURL": "https://mumbai.polygonscan.com/tx/0x66e67706a064724b172b389efecda7100bd605b39e54c3cf20305bf54c5bf3a2",
        "TransactionId": "0x66e67706a064724b172b389efecda7100bd605b39e54c3cf20305bf54c5bf3a2",
        "TokenId": "1",
        "OpenSeaURL": "https://testnets.opensea.io/assets/mumbai/0xaf33691c1b29a5bf098b227062c31c6f1189101d/2"
    },
    "Time": 1661128110153
}
```
| Field | Description |
| :---- | :---------- |
| `Details.ExplorerURL` | a url that redirects to the transaction |
| `Details.TransactionId` | id of the transaction |
| `Details.TokenId` | id of the minted token |
| `Details.OpenSeaURL` | url where the minted nft can be viewed |